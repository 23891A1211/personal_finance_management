<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Finance Tracker</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@2.0.2/build/global/luxon.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
       
        body {
            background: linear-gradient(135deg, #f5f7fa, #c3cfe2);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
        }
       
        header {
            background: var(--primary-gradient);
            color: white;
            padding: 1.5rem 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
       
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }
       
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
       
        .logo {
            font-size: 1.8rem;
            font-weight: bold;
        }
       
        .accent {
            color: #3498db;
        }
       
        main {
            padding: 2rem 0;
        }
       
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
       
        .card {
            background: var(--card-gradient);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            border-radius: 8px;
            padding: 1.5rem;
            transition: transform 0.3s ease;
        }
       
        .card:hover {
            transform: translateY(-5px);
        }
       
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            border-bottom: 1px solid #eee;
            padding-bottom: 0.5rem;
        }
       
        .card h3 {
            font-size: 1.2rem;
            color: #2c3e50;
        }
       
        .amount {
            font-size: 2rem;
            font-weight: bold;
            margin: 1rem 0;
            animation: pulse 2s infinite;
        }
       
        .income {
            color: #2ecc71;
        }
       
        .expense {
            color: #e74c3c;
        }
       
        .neutral {
            color: #3498db;
        }
       
        .chart-container {
            width: 100%;
            height: 250px;
        }
       
        .form-section {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
       
        .form-title {
            margin-bottom: 1.5rem;
            color: #2c3e50;
        }
       
        .form-group {
            margin-bottom: 1rem;
        }
       
        .form-control {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
            background: rgba(255,255,255,0.9);
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }
       
        .form-control:focus {
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
            background: white;
        }
       
        .btn {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: background-color 0.3s ease;
        }
       
        .btn-primary {
            background-color: #3498db;
            color: white;
        }
       
        .btn-primary:hover {
            background-color: #2980b9;
        }
       
        .transactions {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            padding: 1.5rem;
        }
       
        .transaction-list {
            max-height: 400px;
            overflow-y: auto;
        }
       
        .transaction-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid #eee;
            position: relative;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
        }
       
        .transaction-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--primary-gradient);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
       
        .transaction-item:hover {
            transform: translateX(5px);
            background: rgba(255,255,255,0.1);
        }
       
        .transaction-item:hover::before {
            opacity: 1;
        }
       
        .transaction-details h4 {
            margin-bottom: 0.3rem;
        }
       
        .transaction-date {
            font-size: 0.8rem;
            color: #7f8c8d;
        }
       
        .category-tag {
            display: inline-block;
            padding: 0.3rem 0.6rem;
            border-radius: 20px;
            font-size: 0.8rem;
            margin-right: 0.5rem;
            background-color: #f0f0f0;
            background: var(--primary-gradient);
            color: white;
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
       
        .advice-section {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            padding: 1.5rem;
            margin-top: 2rem;
        }
       
        .advice-title {
            color: #2c3e50;
            margin-bottom: 1rem;
        }
       
        .advice-card {
            border-left: 4px solid #3498db;
            padding: 1rem;
            margin-bottom: 1rem;
            background-color: #f8f9fa;
        }
       
        footer {
            background-color: #2c3e50;
            color: white;
            padding: 1.5rem 0;
            text-align: center;
            margin-top: 2rem;
        }
       
        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
           
            .header-content {
                flex-direction: column;
                text-align: center;
            }
        }
       
        /* Enhanced Modern Design */
        :root {
            --primary-gradient: linear-gradient(135deg, #2c3e50, #3498db);
            --card-gradient: linear-gradient(135deg, rgba(255,255,255,0.9), rgba(255,255,255,0.8));
            --success-gradient: linear-gradient(135deg, #2ecc71, #27ae60);
            --danger-gradient: linear-gradient(135deg, #e74c3c, #c0392b);
            --glass-effect: backdrop-filter: blur(10px);
        }
       
        /* Enhanced Animations */
        @keyframes slideIn {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
       
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
       
        .card {
            animation: slideIn 0.5s ease-out forwards;
        }
       
        /* Enhanced Form Styles */
        .form-control {
            background: rgba(255,255,255,0.9);
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }
       
        .form-control:focus {
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
            background: white;
        }
       
        /* Enhanced Transaction List */
        .transaction-item {
            position: relative;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
        }
       
        .transaction-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--primary-gradient);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
       
        .transaction-item:hover {
            transform: translateX(5px);
            background: rgba(255,255,255,0.1);
        }
       
        .transaction-item:hover::before {
            opacity: 1;
        }
       
        /* Enhanced Category Tags */
        .category-tag {
            background: var(--primary-gradient);
            color: white;
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-weight: 500;
            text-transform: uppercase;
            font-size: 0.7rem;
            letter-spacing: 0.5px;
        }
       
        /* New Features */
        .quick-actions {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
        }
       
        .action-btn {
            flex: 1;
            padding: 1rem;
            border: none;
            border-radius: 10px;
            background: var(--primary-gradient);
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
       
        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
       
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
       
        .stat-card {
            background: var(--card-gradient);
            padding: 1.5rem;
            border-radius: 10px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
       
        .stat-card::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--primary-gradient);
        }
       
        /* Loading States */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255,255,255,0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
       
        .loading-overlay.active {
            opacity: 1;
            pointer-events: all;
        }
       
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
       
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Budget Planner Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            z-index: 1000;
            display: none;
            justify-content: center;
            align-items: center;
        }

        .modal {
            background: var(--card-gradient);
            border-radius: 20px;
            padding: 2rem;
            width: 90%;
            max-width: 1000px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid rgba(0, 0, 0, 0.1);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-color);
            transition: transform 0.3s ease;
        }

        .modal-close:hover {
            transform: rotate(90deg);
        }

        .budget-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .budget-category {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 1.5rem;
            position: relative;
            overflow: hidden;
        }

        .budget-category::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--primary-gradient);
        }

        .budget-progress {
            margin: 1rem 0;
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: var(--success-gradient);
            transition: width 0.3s ease;
        }

        .over-budget .progress-bar {
            background: var(--danger-gradient);
        }

        .budget-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .budget-btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            flex: 1;
        }

        .budget-btn-primary {
            background: var(--primary-gradient);
            color: white;
        }

        .budget-btn-secondary {
            background: rgba(0, 0, 0, 0.1);
            color: var(--text-color);
        }

        .budget-summary {
            background: var(--card-gradient);
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .summary-item {
            text-align: center;
        }

        .summary-value {
            font-size: 1.5rem;
            font-weight: bold;
            margin: 0.5rem 0;
        }

        .category-form {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 1.5rem;
            margin-top: 2rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .budget-chart-container {
            height: 300px;
            margin: 2rem 0;
        }

        @media (max-width: 768px) {
            .modal {
                width: 95%;
                padding: 1.5rem;
            }

            .form-row {
                grid-template-columns: 1fr;
            }
        }

        /* Goals Modal Styles */
        .goals-summary {
            background: var(--card-gradient);
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .goals-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .goal-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 1.5rem;
            position: relative;
            overflow: hidden;
            transition: transform 0.3s ease;
        }

        .goal-card:hover {
            transform: translateY(-5px);
        }

        .goal-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--primary-gradient);
        }

        .goal-progress {
            margin: 1rem 0;
            position: relative;
        }

        .goal-progress-bar {
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--success-gradient);
            transition: width 0.3s ease;
            position: relative;
        }

        .goal-milestones {
            display: flex;
            justify-content: space-between;
            margin-top: 0.5rem;
            font-size: 0.8rem;
        }

        .milestone {
            width: 12px;
            height: 12px;
            background: #e2e8f0;
            border-radius: 50%;
            position: absolute;
            top: -2px;
            transform: translateX(-50%);
            transition: background-color 0.3s ease;
        }

        .milestone.reached {
            background: var(--success-gradient);
        }

        .goal-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-top: 1rem;
        }

        .goal-stat {
            text-align: center;
            padding: 0.5rem;
            background: rgba(0, 0, 0, 0.05);
            border-radius: 8px;
        }

        .goals-recommendations {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 1.5rem;
            margin-top: 2rem;
        }

        .recommendation-card {
            background: var(--card-gradient);
            border-radius: 10px;
            padding: 1rem;
            margin-top: 1rem;
            border-left: 4px solid var(--accent-color);
        }

        .goal-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .goal-btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            flex: 1;
        }

        .goal-chart-container {
            height: 300px;
            margin: 2rem 0;
        }

        .priority-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            padding: 0.3rem 0.6rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            text-transform: uppercase;
        }

        .priority-high {
            background: var(--danger-gradient);
            color: white;
        }

        .priority-medium {
            background: var(--primary-gradient);
            color: white;
        }

        .priority-low {
            background: var(--success-gradient);
            color: white;
        }
    </style>
</head>
<body>
    <div class="loading-overlay">
        <div class="spinner"></div>
    </div>

    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">Finance<span class="accent">Tracker</span></div>
                <p>Take control of your financial future</p>
            </div>
        </div>
    </header>
   
    <main class="container">
        <div class="quick-actions">
            <button class="action-btn" onclick="showExportOptions()">
                <i class="fas fa-download"></i> Export Data
            </button>
            <button class="action-btn" onclick="showBudgetPlanner()">
                <i class="fas fa-chart-pie"></i> Budget Planner
            </button>
            <button class="action-btn" onclick="showGoals()">
                <i class="fas fa-bullseye"></i> Financial Goals
            </button>
        </div>

        <div class="stats-container">
            <div class="stat-card">
                <i class="fas fa-chart-line fa-2x"></i>
                <h4>Monthly Growth</h4>
                <span class="stat-value" id="monthly-growth">+12.5%</span>
            </div>
            <div class="stat-card">
                <i class="fas fa-wallet fa-2x"></i>
                <h4>Savings Rate</h4>
                <span class="stat-value" id="savings-rate">27%</span>
            </div>
            <div class="stat-card">
                <i class="fas fa-money-bill-wave fa-2x"></i>
                <h4>Net Worth</h4>
                <span class="stat-value" id="net-worth">Rs.15,240</span>
            </div>
        </div>

        <div class="dashboard">
            <div class="card">
                <div class="card-header">
                    <h3>Total Balance</h3>
                </div>
                <div class="amount neutral" id="total-balance">Rs.2,540.00</div>
                <p>Updated: <span id="last-updated">Feb 27, 2025</span></p>
            </div>
           
            <div class="card">
                <div class="card-header">
                    <h3>Income</h3>
                </div>
                <div class="amount income" id="total-income">Rs.3,500.00</div>
                <p>This month's earnings</p>
            </div>
           
            <div class="card">
                <div class="card-header">
                    <h3>Expenses</h3>
                </div>
                <div class="amount expense" id="total-expenses">Rs.960.00</div>
                <p>This month's spending</p>
            </div>
        </div>
       
        <div class="card">
            <div class="card-header">
                <h3>Spending Overview</h3>
            </div>
            <div class="chart-container" id="spending-chart">
                <!-- Chart will be rendered here -->
                <div style="width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; color: #666;">
                    Chart visualization will appear here with real data
                </div>
            </div>
        </div>
       
        <div class="card">
            <div class="card-header">
                <h3>Spending Trends</h3>
                <select id="trend-period" class="form-control" onchange="updateTrends()">
                    <option value="week">This Week</option>
                    <option value="month" selected>This Month</option>
                    <option value="quarter">This Quarter</option>
                    <option value="year">This Year</option>
                </select>
            </div>
            <div class="chart-container" id="trends-chart"></div>
        </div>
       
        <div class="form-section">
            <h2 class="form-title">Add New Transaction</h2>
            <form id="transaction-form">
                <div class="form-group">
                    <label for="transaction-type">Type</label>
                    <select id="transaction-type" class="form-control">
                        <option value="income">Income</option>
                        <option value="expense">Expense</option>
                    </select>
                </div>
               
                <div class="form-group">
                    <label for="transaction-amount">Amount</label>
                    <input type="number" id="transaction-amount" class="form-control" placeholder="Enter amount" required>
                </div>
               
                <div class="form-group">
                    <label for="transaction-category">Category</label>
                    <select id="transaction-category" class="form-control">
                        <option value="salary">Salary</option>
                        <option value="freelance">Freelance</option>
                        <option value="investment">Investment</option>
                        <option value="grocery">Grocery</option>
                        <option value="utilities">Utilities</option>
                        <option value="entertainment">Entertainment</option>
                        <option value="dining">Dining</option>
                        <option value="transportation">Transportation</option>
                        <option value="healthcare">Healthcare</option>
                        <option value="education">Education</option>
                        <option value="other">Other</option>
                    </select>
                </div>
               
                <div class="form-group">
                    <label for="transaction-date">Date</label>
                    <input type="date" id="transaction-date" class="form-control" required>
                </div>
               
                <div class="form-group">
                    <label for="transaction-description">Description</label>
                    <input type="text" id="transaction-description" class="form-control" placeholder="Enter description">
                </div>
               
                <button type="submit" class="btn btn-primary">Add Transaction</button>
            </form>
        </div>
       
        <div class="transactions">
            <h2 class="form-title">Recent Transactions</h2>
            <div class="transaction-list" id="transaction-list">
                <!-- Transactions will be added here dynamically -->
                <div class="transaction-item">
                    <div class="transaction-details">
                        <h4>Salary</h4>
                        <span class="transaction-date">Feb 15, 2025</span>
                        <div>
                            <span class="category-tag">Income</span>
                        </div>
                    </div>
                    <div class="amount income">+Rs.3,500.00</div>
                </div>
               
                <div class="transaction-item">
                    <div class="transaction-details">
                        <h4>Grocery Shopping</h4>
                        <span class="transaction-date">Feb 20, 2025</span>
                        <div>
                            <span class="category-tag">Grocery</span>
                        </div>
                    </div>
                    <div class="amount expense">-Rs.150.00</div>
                </div>
               
                <div class="transaction-item">
                    <div class="transaction-details">
                        <h4>Electric Bill</h4>
                        <span class="transaction-date">Feb 22, 2025</span>
                        <div>
                            <span class="category-tag">Utilities</span>
                        </div>
                    </div>
                    <div class="amount expense">-Rs.85.00</div>
                </div>
               
                <div class="transaction-item">
                    <div class="transaction-details">
                        <h4>Dinner with Friends</h4>
                        <span class="transaction-date">Feb 24, 2025</span>
                        <div>
                            <span class="category-tag">Dining</span>
                        </div>
                    </div>
                    <div class="amount expense">-Rs.65.00</div>
                </div>
            </div>
        </div>
       
        <div class="advice-section">
            <h2 class="advice-title">Financial Insights & Advice</h2>
            <div id="advice-container">
                <div class="advice-card">
                    <h4>Spending Alert</h4>
                    <p>Your dining expenses are 15% higher than last month. Consider cooking more meals at home to reduce costs.</p>
                </div>
               
                <div class="advice-card">
                    <h4>Saving Opportunity</h4>
                    <p>Based on your income, you could increase your monthly savings by Rs.200 to meet your long-term goals faster.</p>
                </div>
               
                <div class="advice-card">
                    <h4>Budget Tip</h4>
                    <p>Setting up automatic transfers to your savings account on payday can help maintain consistent saving habits.</p>
                </div>
            </div>
        </div>
    </main>
   
    <footer>
        <div class="container">
            <p>&copy; 2025 FinanceTracker. All rights reserved.</p>
        </div>
    </footer>
   
    <div class="modal-overlay" id="budgetModal">
        <div class="modal">
            <div class="modal-header">
                <h2>Budget Planner</h2>
                <button class="modal-close" onclick="closeBudgetPlanner()">&times;</button>
            </div>

            <div class="budget-summary">
                <div class="summary-grid">
                    <div class="summary-item">
                        <h3>Total Budget</h3>
                        <div class="summary-value" id="totalBudget">Rs.5,000</div>
                    </div>
                    <div class="summary-item">
                        <h3>Spent</h3>
                        <div class="summary-value" id="totalSpent">Rs.3,250</div>
                    </div>
                    <div class="summary-item">
                        <h3>Remaining</h3>
                        <div class="summary-value" id="totalRemaining">Rs.1,750</div>
                    </div>
                    <div class="summary-item">
                        <h3>Savings Goal</h3>
                        <div class="summary-value" id="savingsGoal">Rs.1,000</div>
                    </div>
                </div>
            </div>

            <div class="budget-chart-container">
                <canvas id="budgetOverviewChart"></canvas>
            </div>

            <div class="budget-grid" id="budgetCategories">
                <!-- Budget categories will be populated here -->
            </div>

            <div class="category-form">
                <h3>Add New Category</h3>
                <form id="categoryForm" onsubmit="addBudgetCategory(event)">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="categoryName">Category Name</label>
                            <input type="text" id="categoryName" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="budgetAmount">Budget Amount</label>
                            <input type="number" id="budgetAmount" class="form-control" min="0" required>
                        </div>
                        <div class="form-group">
                            <label for="categoryColor">Category Color</label>
                            <input type="color" id="categoryColor" class="form-control" value="#4299e1">
                        </div>
                    </div>
                    <button type="submit" class="budget-btn budget-btn-primary">Add Category</button>
                </form>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="goalsModal">
        <div class="modal">
            <div class="modal-header">
                <h2>Financial Goals</h2>
                <button class="modal-close" onclick="closeGoals()">&times;</button>
            </div>

            <div class="goals-summary">
                <div class="summary-grid">
                    <div class="summary-item">
                        <h3>Active Goals</h3>
                        <div class="summary-value" id="activeGoals">3</div>
                    </div>
                    <div class="summary-item">
                        <h3>Completed Goals</h3>
                        <div class="summary-value" id="completedGoals">2</div>
                    </div>
                    <div class="summary-item">
                        <h3>Total Saved</h3>
                        <div class="summary-value" id="totalSaved">Rs.12,500</div>
                    </div>
                    <div class="summary-item">
                        <h3>Target Amount</h3>
                        <div class="summary-value" id="targetAmount">Rs.50,000</div>
                    </div>
                </div>
            </div>

            <div class="goals-chart-container">
                <canvas id="goalsOverviewChart"></canvas>
            </div>

            <div class="goals-grid" id="financialGoals">
                <!-- Goals will be populated here -->
            </div>

            <div class="goal-form">
                <h3>Add New Goal</h3>
                <form id="goalForm" onsubmit="addFinancialGoal(event)">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="goalName">Goal Name</label>
                            <input type="text" id="goalName" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="targetAmount">Target Amount</label>
                            <input type="number" id="goalTargetAmount" class="form-control" min="0" required>
                        </div>
                        <div class="form-group">
                            <label for="deadline">Target Date</label>
                            <input type="date" id="goalDeadline" class="form-control" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="goalType">Goal Type</label>
                            <select id="goalType" class="form-control" required>
                                <option value="savings">Savings</option>
                                <option value="investment">Investment</option>
                                <option value="debt">Debt Repayment</option>
                                <option value="purchase">Major Purchase</option>
                                <option value="emergency">Emergency Fund</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="priority">Priority Level</label>
                            <select id="priority" class="form-control" required>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="monthlyContribution">Monthly Contribution</label>
                            <input type="number" id="monthlyContribution" class="form-control" min="0" required>
                        </div>
                    </div>
                    <button type="submit" class="budget-btn budget-btn-primary">Add Goal</button>
                </form>
            </div>

            <div class="goals-recommendations" id="goalRecommendations">
                <h3>Smart Recommendations</h3>
                <!-- Recommendations will be populated here -->
            </div>
        </div>
    </div>

    <script>
        // Initial Data Setup
        let transactions = [
            { id: 1, type: 'income', amount: 3500, category: 'salary', date: '2025-02-15', description: 'Monthly Salary' },
            { id: 2, type: 'expense', amount: 150, category: 'grocery', date: '2025-02-20', description: 'Grocery Shopping' },
            { id: 3, type: 'expense', amount: 85, category: 'utilities', date: '2025-02-22', description: 'Electric Bill' },
            { id: 4, type: 'expense', amount: 65, category: 'dining', date: '2025-02-24', description: 'Dinner with Friends' }
        ];

        let budgetCategories = [
            { id: 1, name: 'Housing', budget: 2000, spent: 1800, color: '#4299e1' },
            { id: 2, name: 'Transportation', budget: 500, spent: 350, color: '#48bb78' },
            { id: 3, name: 'Food', budget: 800, spent: 600, color: '#ed8936' },
            { id: 4, name: 'Utilities', budget: 400, spent: 380, color: '#9f7aea' },
            { id: 5, name: 'Entertainment', budget: 300, spent: 120, color: '#ed64a6' }
        ];

        let userData = {
            income: 3500,
            expenses: 960,
            balance: 2540,
            budget: {
                grocery: 400,
                utilities: 300,
                entertainment: 200,
                dining: 300,
                transportation: 150,
                healthcare: 200,
                education: 100,
                other: 200
            },
            spending: {
                grocery: 380,
                utilities: 285,
                entertainment: 120,
                dining: 150,
                transportation: 90,
                healthcare: 0,
                education: 30,
                other: 40
            }
        };

        // DOM Elements
        const transactionForm = document.getElementById('transaction-form');
        const transactionList = document.getElementById('transaction-list');
        const totalBalance = document.getElementById('total-balance');
        const totalIncome = document.getElementById('total-income');
        const totalExpenses = document.getElementById('total-expenses');
        const adviceContainer = document.getElementById('advice-container');
        const budgetModal = document.getElementById('budgetModal');
        const budgetCategoriesContainer = document.getElementById('budgetCategories');

        // Initialize Application
        async function initialize() {
            showLoading();
            try {
                // Load saved data first
                loadFromLocalStorage();

                // Initialize core data
                calculateTotals();
                updateTotalDisplay();
                
                // Setup event listeners first
                setupEventListeners();

                // Initialize UI components one by one with error handling
                await initializeUIComponents();

                // Start real-time updates
                startPerformanceUpdates();
            } catch (error) {
                console.error('Initialization error:', error);
                // Show a more helpful error message
                const errorMessage = document.createElement('div');
                errorMessage.style.cssText = 'position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: #f44336; color: white; padding: 15px; border-radius: 5px; z-index: 9999;';
                errorMessage.textContent = 'There was an error loading the application. Please try refreshing the page.';
                document.body.appendChild(errorMessage);
                setTimeout(() => errorMessage.remove(), 5000);
            } finally {
                hideLoading();
            }
        }

        // Separate function to initialize UI components
        async function initializeUIComponents() {
            const tasks = [];

            // Initialize charts if their containers exist
            if (document.getElementById('spending-chart')) {
                tasks.push(initializeSpendingChart().catch(err => console.warn('Spending chart initialization failed:', err)));
            }
            if (document.getElementById('trends-chart')) {
                tasks.push(initializeTrendsChart().catch(err => console.warn('Trends chart initialization failed:', err)));
            }
            if (document.getElementById('budgetOverviewChart')) {
                tasks.push(initializeBudgetChart().catch(err => console.warn('Budget chart initialization failed:', err)));
            }

            // Add other UI updates
            tasks.push(
                renderTransactions().catch(err => console.warn('Transaction rendering failed:', err)),
                renderBudgetCategories().catch(err => console.warn('Budget categories rendering failed:', err)),
                updateBudgetSummary().catch(err => console.warn('Budget summary update failed:', err)),
                generateAdvice().catch(err => console.warn('Advice generation failed:', err))
            );

            // Wait for all tasks to complete, but don't fail if some fail
            await Promise.allSettled(tasks);
        }

        // Make renderTransactions return a Promise
        function renderTransactions() {
            return new Promise((resolve) => {
                const transactionList = document.getElementById('transaction-list');
                if (!transactionList) {
                    resolve();
                    return;
                }

                transactionList.innerHTML = transactions
                    .sort((a, b) => new Date(b.date) - new Date(a.date))
                    .map(transaction => `
                        <div class="transaction-item">
                            <div class="transaction-details">
                                <h4>${transaction.description}</h4>
                                <span class="transaction-date">${new Date(transaction.date).toLocaleDateString()}</span>
                                <div>
                                    <span class="category-tag">${transaction.category}</span>
                                </div>
                            </div>
                            <div class="amount ${transaction.type}">
                                ${transaction.type === 'income' ? '+' : '-'}Rs.${transaction.amount.toLocaleString()}
                            </div>
                        </div>
                    `).join('');
                resolve();
            });
        }

        // Make renderBudgetCategories return a Promise
        function renderBudgetCategories() {
            return new Promise((resolve) => {
                if (!budgetCategoriesContainer) {
                    resolve();
                    return;
                }

                budgetCategoriesContainer.innerHTML = budgetCategories.map(category => {
                    const percentage = (category.spent / category.budget) * 100;
                    return `
                        <div class="budget-category">
                            <div class="category-header">
                                <h3>${category.name}</h3>
                                <span style="color: ${category.color}">
                                    Rs.${category.spent.toLocaleString()} / Rs.${category.budget.toLocaleString()}
                                </span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${percentage}%; background: ${category.color}"></div>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-top: 0.5rem;">
                                <span>${percentage.toFixed(1)}% used</span>
                                <span>Rs.${(category.budget - category.spent).toLocaleString()} remaining</span>
                            </div>
                            <div class="budget-actions">
                                <button onclick="editBudget(${category.id})" class="budget-btn budget-btn-secondary">
                                    Edit Budget
                                </button>
                                <button onclick="addExpense(${category.id})" class="budget-btn budget-btn-secondary">
                                    Add Expense
                                </button>
                            </div>
                        </div>
                    `;
                }).join('');
                resolve();
            });
        }

        // Make updateBudgetSummary return a Promise
        function updateBudgetSummary() {
            return new Promise((resolve) => {
                const totalBudget = budgetCategories.reduce((sum, cat) => sum + cat.budget, 0);
                const totalSpent = budgetCategories.reduce((sum, cat) => sum + cat.spent, 0);
                const remaining = totalBudget - totalSpent;

                const elements = {
                    totalBudget: document.getElementById('totalBudget'),
                    totalSpent: document.getElementById('totalSpent'),
                    totalRemaining: document.getElementById('totalRemaining')
                };

                if (elements.totalBudget) elements.totalBudget.textContent = `Rs.${totalBudget.toLocaleString()}`;
                if (elements.totalSpent) elements.totalSpent.textContent = `Rs.${totalSpent.toLocaleString()}`;
                if (elements.totalRemaining) elements.totalRemaining.textContent = `Rs.${remaining.toLocaleString()}`;
                resolve();
            });
        }

        // Make generateAdvice return a Promise
        function generateAdvice() {
            return new Promise((resolve) => {
                if (!adviceContainer) {
                    resolve();
                    return;
                }

                const advice = [];
                
                budgetCategories.forEach(category => {
                    const percentage = (category.spent / category.budget) * 100;
                    if (percentage > 90) {
                        advice.push(`
                            <div class="advice-card">
                                <h4>Budget Alert</h4>
                                <p>You've used ${percentage.toFixed(1)}% of your ${category.name} budget. Consider reducing expenses in this category.</p>
                            </div>
                        `);
                    }
                });

                const savingsRate = ((userData.income - userData.expenses) / userData.income) * 100;
                if (savingsRate < 20) {
                    advice.push(`
                        <div class="advice-card">
                            <h4>Saving Opportunity</h4>
                            <p>Your current savings rate is ${savingsRate.toFixed(1)}%. Try to save at least 20% of your income.</p>
                        </div>
                    `);
                }

                adviceContainer.innerHTML = advice.join('');
                resolve();
            });
        }

        // Event Listeners Setup
        function setupEventListeners() {
            const form = document.getElementById('transaction-form');
            if (form) {
                form.addEventListener('submit', handleTransactionSubmit);
            }

            const trendPeriod = document.getElementById('trend-period');
            if (trendPeriod) {
                trendPeriod.addEventListener('change', updateTrends);
            }

            // Budget planner event listeners
            const categoryForm = document.getElementById('categoryForm');
            if (categoryForm) {
                categoryForm.addEventListener('submit', addBudgetCategory);
            }

            // Goals event listeners
            const goalForm = document.getElementById('goalForm');
            if (goalForm) {
                goalForm.addEventListener('submit', addFinancialGoal);
            }
        }

        // Transaction Handling
        function handleTransactionSubmit(event) {
            event.preventDefault();
            
            const formData = {
                type: document.getElementById('transaction-type').value,
                amount: parseFloat(document.getElementById('transaction-amount').value),
                category: document.getElementById('transaction-category').value,
                description: document.getElementById('transaction-description').value,
                date: document.getElementById('transaction-date').value || new Date().toISOString().split('T')[0]
            };

            if (!formData.amount || isNaN(formData.amount)) {
                showError('Please enter a valid amount');
                return;
            }

            const newTransaction = {
                id: transactions.length + 1,
                ...formData
            };

            addTransaction(newTransaction);
            event.target.reset();
            
            // Show success message
            const successMessage = document.createElement('div');
            successMessage.className = 'alert alert-success';
            successMessage.textContent = 'Transaction added successfully!';
            event.target.insertBefore(successMessage, event.target.firstChild);
            
            // Remove success message after 3 seconds
            setTimeout(() => successMessage.remove(), 3000);
        }

        function addTransaction(transaction) {
            transactions.push(transaction);

            // Update user data
            if (transaction.type === 'income') {
                userData.income += transaction.amount;
            } else {
                userData.expenses += transaction.amount;
                updateCategorySpending(transaction.category, transaction.amount);
            }

            userData.balance = userData.income - userData.expenses;

            // Update UI
            updateUI();
            
            // Save to localStorage
            saveToLocalStorage();
        }

        function updateCategorySpending(category, amount) {
            // Update user data spending
            if (userData.spending[category] !== undefined) {
                userData.spending[category] += amount;
            } else {
                userData.spending[category] = amount;
            }

            // Update budget categories
            const budgetCategory = budgetCategories.find(cat => 
                cat.name.toLowerCase() === category.toLowerCase());
            if (budgetCategory) {
                budgetCategory.spent += amount;
            }
        }

        // Save and Load Data
        function saveToLocalStorage() {
            const data = {
                transactions,
                userData,
                budgetCategories
            };
            localStorage.setItem('financeTrackerData', JSON.stringify(data));
        }

        function loadFromLocalStorage() {
            const savedData = localStorage.getItem('financeTrackerData');
            if (savedData) {
                const data = JSON.parse(savedData);
                transactions = data.transactions;
                userData = data.userData;
                budgetCategories = data.budgetCategories;
            }
        }

        // Update UI
        function updateUI() {
            calculateTotals();
            updateTotalDisplay();
            renderTransactions();
            renderBudgetCategories();
            updateBudgetSummary();
            generateAdvice();
            
            // Update charts
            initializeCharts();
        }

        function updateTotalDisplay() {
            if (totalBalance) totalBalance.textContent = `Rs.${userData.balance.toLocaleString()}`;
            if (totalIncome) totalIncome.textContent = `Rs.${userData.income.toLocaleString()}`;
            if (totalExpenses) totalExpenses.textContent = `Rs.${userData.expenses.toLocaleString()}`;
        }

        function calculateTotals() {
            userData.income = transactions
                .filter(t => t.type === 'income')
                .reduce((sum, t) => sum + t.amount, 0);

            userData.expenses = transactions
                .filter(t => t.type === 'expense')
                .reduce((sum, t) => sum + t.amount, 0);

            userData.balance = userData.income - userData.expenses;
        }

        // Utility Functions
        function showLoading() {
            const overlay = document.querySelector('.loading-overlay');
            if (overlay) overlay.classList.add('active');
        }

        function hideLoading() {
            const overlay = document.querySelector('.loading-overlay');
            if (overlay) overlay.classList.remove('active');
        }

        function showError(message) {
            alert(message);
        }

        // Budget Management
        function showBudgetPlanner() {
            if (budgetModal) {
                budgetModal.style.display = 'flex';
                renderBudgetCategories();
                updateBudgetSummary();
                initializeBudgetChart();
            }
        }

        function closeBudgetPlanner() {
            if (budgetModal) {
                budgetModal.style.display = 'none';
            }
        }

        function addBudgetCategory(event) {
            event.preventDefault();
            
            const formData = {
                name: document.getElementById('categoryName').value,
                budget: parseFloat(document.getElementById('budgetAmount').value),
                color: document.getElementById('categoryColor').value
            };

            if (!formData.budget || isNaN(formData.budget)) {
                showError('Please enter a valid budget amount');
                return;
            }

            const newCategory = {
                id: budgetCategories.length + 1,
                name: formData.name,
                budget: formData.budget,
                spent: 0,
                color: formData.color || '#' + Math.floor(Math.random()*16777215).toString(16)
            };

            budgetCategories.push(newCategory);
            userData.budget[newCategory.name.toLowerCase()] = newCategory.budget;
            userData.spending[newCategory.name.toLowerCase()] = 0;

            updateUI();
            saveToLocalStorage();
            event.target.reset();

            // Show success message
            const successMessage = document.createElement('div');
            successMessage.className = 'alert alert-success';
            successMessage.textContent = 'Budget category added successfully!';
            event.target.insertBefore(successMessage, event.target.firstChild);
            
            // Remove success message after 3 seconds
            setTimeout(() => successMessage.remove(), 3000);
        }

        function editBudget(categoryId) {
            const category = budgetCategories.find(cat => cat.id === categoryId);
            if (!category) return;

            const newBudget = prompt(`Enter new budget for ${category.name}:`, category.budget);
            if (newBudget === null || isNaN(newBudget)) return;

            category.budget = parseFloat(newBudget);
            userData.budget[category.name.toLowerCase()] = category.budget;
            
            updateUI();
            saveToLocalStorage();
        }

        function addExpense(categoryId) {
            const category = budgetCategories.find(cat => cat.id === categoryId);
            if (!category) return;

            const expense = prompt(`Enter expense amount for ${category.name}:`, 0);
            if (expense === null || isNaN(expense)) return;

            const amount = parseFloat(expense);
            if (amount <= 0) {
                showError('Please enter a valid expense amount');
                return;
            }
            
            const newTransaction = {
                id: transactions.length + 1,
                type: 'expense',
                amount: amount,
                category: category.name.toLowerCase(),
                description: `${category.name} Expense`,
                date: new Date().toISOString().split('T')[0]
            };

            addTransaction(newTransaction);
        }

        function initializeBudgetChart() {
            const ctx = document.getElementById('budgetOverviewChart');
            if (!ctx) return;

            if (window.budgetChart) {
                window.budgetChart.destroy();
            }

            window.budgetChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: budgetCategories.map(cat => cat.name),
                    datasets: [{
                        label: 'Budget',
                        data: budgetCategories.map(cat => cat.budget),
                        backgroundColor: budgetCategories.map(cat => cat.color + '80'),
                        borderColor: budgetCategories.map(cat => cat.color),
                        borderWidth: 1
                    }, {
                        label: 'Spent',
                        data: budgetCategories.map(cat => cat.spent),
                        backgroundColor: budgetCategories.map(cat => cat.color + '40'),
                        borderColor: budgetCategories.map(cat => cat.color),
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: value => 'Rs.' + value.toLocaleString()
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': Rs.' + context.parsed.y.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });
        }

        // Initialize spending chart
        function initializeSpendingChart() {
            return new Promise((resolve, reject) => {
                try {
                    const ctx = document.getElementById('spending-chart');
                    if (!ctx) {
                        resolve();
                        return;
                    }

                    const categories = Object.keys(userData.spending);
                    const spendingData = categories.map(cat => userData.spending[cat]);
                    const budgetData = categories.map(cat => userData.budget[cat]);

                    new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: categories.map(cat => cat.charAt(0).toUpperCase() + cat.slice(1)),
                            datasets: [{
                                label: 'Spent',
                                data: spendingData,
                                backgroundColor: 'rgba(231, 76, 60, 0.7)',
                                borderColor: '#e74c3c',
                                borderWidth: 1
                            }, {
                                label: 'Budget',
                                data: budgetData,
                                backgroundColor: 'rgba(46, 204, 113, 0.7)',
                                borderColor: '#2ecc71',
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    ticks: {
                                        callback: value => 'Rs.' + value.toLocaleString()
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    position: 'top'
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            return context.dataset.label + ': Rs.' + context.parsed.y.toLocaleString();
                                        }
                                    }
                                }
                            }
                        }
                    });
                    resolve();
                } catch (error) {
                    console.warn('Spending chart initialization failed:', error);
                    resolve(); // Resolve anyway to not block other components
                }
            });
        }

        // Initialize trends chart
        function initializeTrendsChart() {
            return new Promise((resolve, reject) => {
                try {
                    const ctx = document.getElementById('trends-chart');
                    if (!ctx) {
                        resolve();
                        return;
                    }

                    const dates = Array.from({length: 30}, (_, i) => {
                        const date = new Date();
                        date.setDate(date.getDate() - (29 - i));
                        return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                    });

                    const incomeData = Array.from({length: 30}, () => Math.floor(Math.random() * 1000) + 3000);
                    const expenseData = Array.from({length: 30}, () => Math.floor(Math.random() * 800) + 200);

                    new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: dates,
                            datasets: [{
                                label: 'Income',
                                data: incomeData,
                                borderColor: '#2ecc71',
                                backgroundColor: 'rgba(46, 204, 113, 0.1)',
                                tension: 0.4,
                                fill: true
                            }, {
                                label: 'Expenses',
                                data: expenseData,
                                borderColor: '#e74c3c',
                                backgroundColor: 'rgba(231, 76, 60, 0.1)',
                                tension: 0.4,
                                fill: true
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'top'
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    ticks: {
                                        callback: value => 'Rs.' + value.toLocaleString()
                                    }
                                }
                            }
                        }
                    });
                    resolve();
                } catch (error) {
                    console.warn('Trends chart initialization failed:', error);
                    resolve(); // Resolve anyway to not block other components
                }
            });
        }

        // Start performance updates
        function startPerformanceUpdates() {
            setInterval(() => {
                updatePerformanceMetrics();
            }, 5000);
        }

        // Update performance metrics
        function updatePerformanceMetrics() {
            const elements = {
                monthlyGrowth: document.getElementById('monthly-growth'),
                savingsRate: document.getElementById('savings-rate'),
                netWorth: document.getElementById('net-worth')
            };

            if (elements.monthlyGrowth) {
                const growth = ((Math.random() * 5) - 1).toFixed(1);
                elements.monthlyGrowth.textContent = `${growth}%`;
                elements.monthlyGrowth.style.color = parseFloat(growth) >= 0 ? '#2ecc71' : '#e74c3c';
            }

            if (elements.savingsRate) {
                const rate = ((userData.income - userData.expenses) / userData.income * 100).toFixed(1);
                elements.savingsRate.textContent = `${rate}%`;
            }

            if (elements.netWorth) {
                const worth = userData.balance + (Math.random() - 0.5) * 100;
                elements.netWorth.textContent = `Rs.${Math.round(worth).toLocaleString()}`;
            }
        }

        // Initialize all charts
        function initializeCharts() {
            return Promise.all([
                initializeSpendingChart(),
                initializeTrendsChart(),
                initializeBudgetChart()
            ]).catch(error => {
                console.warn('Chart initialization error:', error);
            });
        }

        // Update trends
        function updateTrends() {
            initializeTrendsChart();
        }

        // Load saved data when the application starts
        document.addEventListener('DOMContentLoaded', () => {
            loadFromLocalStorage();
            initialize();
        });
    </script>
</body>
</html>